openapi: 3.0.4
info:
  title: Traveler Social Network API
  description: |-
    ## –û–±–∑–æ—Ä–Ω—ã–π REST API –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º–æ–π —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –¥–ª—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤
    
    ### [–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞](https://github.com/zkryaev/social_network_system_design)
  version: 0.0.1
tags:
  - name: posts
    description: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - name: subscriptions
    description: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
  - name: likes
    description: –õ–∞–π–∫–∏
  - name: comments
    description: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
  - name: search
    description: –ü–æ–∏—Å–∫ –ø–æ—Å—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - name: travelers
    description: –ü—Ä–æ—Ñ–∏–ª—å –∏ –ª–µ–Ω—Ç–∞ –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤
  - name: media
    description: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞

paths:
  /posts:
    post:
      tags:
        - posts
      summary: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç
      operationId: createPost
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BasePost'
      responses:
        '200':
          description: –ü–æ—Å—Ç —Å–æ–∑–¥–∞–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetPost'
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

    get:
      tags:
        - posts
      summary: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤
      operationId: listPosts
      parameters:
        - name: title
          in: query
          required: false
          schema:
            type: string
        - name: geo_tag
          in: query
          required: false
          schema:
            type: integer
        - name: author_id
          in: query
          required: false
          schema:
            type: integer
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
      responses:
        '200':
          description: –ü–æ—Å—Ç —Å–æ–∑–¥–∞–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetPost'
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

    put:
      tags:
        - posts
      summary: –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ—Å—Ç
      operationId: updatePost
      requestBody:
        description: –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç–∞
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BasePost'
      responses:
        '200':
          description: –ü–æ—Å—Ç –æ–±–Ω–æ–≤–ª—ë–Ω
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π ID –ø–æ—Å—Ç–∞
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    
    delete:
      tags:
        - posts
      summary: –£–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ—Å—Ç
      operationId: deletePost
      parameters:
        - name: post_id
          in: query
          required: true
          schema:
            type : integer
      responses:
        '200':
          description: –ü–æ—Å—Ç —É–¥–∞–ª–µ–Ω
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π ID –ø–æ—Å—Ç–∞
        '404':
          description: –ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

  /travelers:
    post:
      tags:
        - travelers
      summary: –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
      operationId: postProfile
      requestBody:
        content:
            application/json:
              schema:
                $ref: '#/components/schemas/Traveler'
      responses:
        '200':
          description: –°–æ–∑–¥–∞–Ω –ø—Ä–æ—Ñ–∏–ª—å
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Traveler'
        '400':
          description: ''
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    get:
      tags:
        - travelers
      summary: –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
      operationId: getProfile
      parameters:
        - name: traveler_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: –ü–æ–ª—É—á–µ–Ω –ø—Ä–æ—Ñ–∏–ª—å
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Traveler'
        '404':
          description: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    put:
      tags:
        - travelers
      summary: –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
      operationId: putProfile
      requestBody:
        content:
            application/json:
              schema:
                $ref: '#/components/schemas/Traveler'
      responses:
        '200':
          description: –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑–º–µ–Ω–µ–Ω—ã
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Traveler'
        '400':
          description: ''
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    delete:
      tags:
        - travelers
      summary: –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
      operationId: deleteProfile
      responses:
        '200':
          description: –ü—Ä–æ—Ñ–∏–ª—å —É–¥–∞–ª–µ–Ω
        '400':
          description: ''
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

  /posts/likes:
    post:
      tags:
        - likes
      summary: –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫
      operationId: postLike
      parameters:
        - name: post_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
        '400':
          description: ''
        '404':
          description: –ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: ''
      
    get:
      tags:
        - likes
      summary: –ü–æ–ª—É—á–∏—Ç—å –ª–∞–π–∫–∏
      operationId: getLike
      parameters:
        - name: post_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Like'
        '400':
          description: ''
        '404':
          description: –ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: ''
          
    delete:
      tags:
        - likes
      summary: –£–¥–∞–ª–∏—Ç—å –ª–∞–π–∫
      operationId: deleteLike
      parameters:
        - name: post_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
        '400':
          description: ''
        '404':
          description: –ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: ''

  /posts/comments:
    post:
      tags:
        - comments
      summary: –ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
      operationId: postComment
      requestBody:
        description: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Comment'
      responses:
        '200':
          description: –£—Å–ø–µ—à–Ω–æ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Comment'
        '400':
          description: ''
        '404':
          description: –ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: ''
          
    get:
      tags:
        - comments
      summary: –ü–æ–ª—É—á–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
      operationId: getComments
      parameters:
        - name: post_id
          in: query
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
      responses:
        '200':
          description: –°–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Comment'
        '400':
          description: ''
        '404':
          description: –ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: ''

    put:
      tags:
        - comments
      summary: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
      operationId: putComment
      requestBody:
        description: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Comment'
      responses:
        '200':
          description: ''
        '400':
          description: ''
        '500':
          description: ''
          
  /travelers/subscriptions:
    post:
      tags:
        - subscriptions
      summary: –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è
      operationId: postSubscribe
      requestBody:
        description: –ü–æ–¥–ø–∏—Å–∫–∞
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BaseSubscription'
      responses:
        '200':
          description: ''
        '400':
          description: ''
        '500':
          description: ''
          
    get:
      tags:
        - subscriptions
      summary: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫ –∏–ª–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
      operationId: getSubscribes
      parameters:
        - name: traveler_id
          in: query
          required: true
          schema:
            type: integer
        - name: page
          in: query
          required: true
          schema:
            type: integer
        - name: is_subs
          in: query
          required: true
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: –ü–æ–¥–ø–∏—Å–∞–Ω
          content:
            application/json:
              schema:
                description: –°–ø–∏—Å–æ–∫ ID –ø–æ–¥–ø–∏—Å–æ–∫/–ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
                type: array
                items:
                  properties:
                    subscriptionId:
                      type: integer
                      format: int64
                      example: 123
        '400':
          description: ''
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

    delete:
      tags:
        - subscriptions
      summary: –û—Ç–ø–∏—Å–∞—Ç—å—Å—è
      operationId: deleteSubscribes
      parameters:
        - name: subscribe_id
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ''
        '400':
          description: ''
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
          
  /media:
    post:
      tags:
        - media
      summary: –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
      operationId: postMedia
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                  format: int64
                  description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∫–∏
                post_id:
                  type: integer
                  format: int64
                  description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞
                image:
                  type: string
                  format: binary
                  description: –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPEG, PNG, GIF)
              required:
                - image
        required: true
      responses:
        '200':
          description: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                    example: "https://cdn.example.com/images/a1b2c3d4.jpg"
                  thumbnailUrl:
                    type: string
                    format: uri
                    example: "https://cdn.example.com/thumbs/a1b2c3d4.jpg"
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª
        '422':
          description: –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

    put:
      tags:
        - media
      summary: –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ—Å—Ç
      operationId: putMedia
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                  format: int64
                  description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∫–∏
                post_id:
                  type: integer
                  format: int64
                  description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞
                image:
                  type: string
                  format: binary
                  description: –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPEG, PNG, GIF)
              required:
                - image
      responses:
        '200':
          description: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                    example: "https://cdn.example.com/images/a1b2c3d4.jpg"
                  thumbnailUrl:
                    type: string
                    format: uri
                    example: "https://cdn.example.com/thumbs/a1b2c3d4.jpg"
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª
        '422':
          description: –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    
    delete:
      tags:
        - media
      summary: –£–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ—Å—Ç
      operationId: deleteMedia
      parameters:
        - name: image_url
          in: query
          required: false
          schema:
            type: string
            example: "https://cdn.example.com/thumbs/a1b2c3d4.jpg"
      responses:
        '200':
          description: –ü–æ—Å—Ç —É–¥–∞–ª–µ–Ω
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–π ID –ø–æ—Å—Ç–∞
        '404':
          description: –ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        '500':
          description: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

components:
  schemas:
    Like:
      type: object
      properties:
        post_id:
          type: integer
          format: int64
          example: 3
        likes:
          type: integer
          format: int64
          example: 1024
      required:
        - user_id
        - post_id
    Comment:
      type: object
      properties:
        comment_id:
          type: integer
          format: int64
          example: 1
        user_id:
          type: integer
          format: int64
          example: 2
        post_id:
          type: integer
          format: int64
          example: 3
        total:
          type: integer
          format: int64
          example: 74
        text:
          type: string
          example: '–ö–ª–∞—Å—Å–Ω—ã–π –∫–∞–¥—Ä!'
        createdAt:
          type: string
          format: date-time
          example: "2025-04-05T12:00:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-04-05T12:00:00Z"
      required:
        - user_id
        - post_id
  
    BaseSubscription:
      type: object
      properties:
        user_id:
          type: integer
          format: int64
          example: 10
        target_id:
          type: integer
          format: int64
          example: 10
        createdAt:
          type: string
          format: date-time
          example: "2025-04-05T12:00:00Z"
      required:
        - user_id
        - target_id
    
    Traveler:
      type: object
      properties:
        traveler_id:
          type: integer
          format: int64
          example: 10
        username:
          type: string
          example: travel_guru
        firstName:
          type: string
          example: –ê–ª–µ–∫—Å–µ–π
        lastName:
          type: string
          example: –ò–≤–∞–Ω–æ–≤
        email:
          type: string
          example: alex@example.com
        bio:
          type: string
          example: –õ—é–±–ª—é –≥–æ—Ä—ã –∏ –º–æ—Ä–µ üåÑüåä
        avatarUrl:
          type: string
          example: https://example.com/avatars/alex.jpg
        createdAt:
          type: string
          format: date-time
          example: "2025-04-05T12:00:00Z"
      required:
        - username
        - email

    BasePost:
      type: object
      properties:
        authorId:
          type: integer
          format: int64
          example: 10
        title:
          type: string
          example: "–ú–æ–π –ø–æ—Ö–æ–¥ –Ω–∞ –ë–∞–π–∫–∞–ª!"
        location:
          type: string
          example: "–†–æ—Å—Å–∏—è, –ë–∞–π–∫–∞–ª"
        createdAt:
          type: string
          format: date-time
          example: "2025-04-05T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-04-05T10:30:00Z"
      required:
        - title
        - authorId
        
    GetPost:
      allOf:
        - $ref: '#/components/schemas/BasePost'
        - type: object
          properties:
            id:
              type: integer
              format: int64
              example: 101
            images_url:
              type: array
              description: –°–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ—Å—Ç–∞
              items:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                    example: "https://cdn.example.com/images/7a3f9b1c.jpg"
                  thumbnailUrl:
                    type: string
                    format: uri
                    example: "https://cdn.example.com/thumbs/7a3f9b1c.jpg"
              minItems: 0